function randomFromTo(a,b){return Math.floor(Math.random()*(b-a+1)+a)}function update(a){var b=a-oldtimestamp;oldtimestamp=a,null===start&&(start=a),a-start>maxconfettitime&&(endConfetti=!0),angle+=.02*b,tiltAngle+=.1*b,TiltChangeCountdown=-1*b;for(var c=0;c<particles.length;c++){var d=particles[c];d.tiltAngle+=d.tiltAngleIncremental,d.y+=(2*Math.cos(angle+d.d)+1+d.r/2)/2,d.x+=3*Math.sin(.1*angle+d.d),d.tilt=15*Math.sin(d.tiltAngle-d.num/3),(d.x>W+5||d.x<-5||d.y>H)&&(endConfetti?particles.splice(c,1):c%5>0||c%2==0?particles[c]={num:c,x:Math.random()*W,y:-10,r:d.r,d:d.d,color:d.color,tilt:Math.floor(10*Math.random())-10,tiltAngle:d.tiltAngle,tiltAngleIncremental:d.tiltAngleIncremental}:Math.sin(angle)>0?particles[c]={num:c,x:-5,y:Math.random()*H,r:d.r,d:d.d,color:d.color,tilt:Math.floor(10*Math.random())-10,tiltAngleIncremental:d.tiltAngleIncremental}:particles[c]={num:c,x:W+5,y:Math.random()*H,r:d.r,d:d.d,color:d.color,tilt:Math.floor(10*Math.random())-10,tiltAngleIncremental:d.tiltAngleIncremental})}particles.length<1?StopConfetti():requestAnimationFrame(draw)}function StartConfetti(){$(canvas).addClass("active"),ctx=canvas.getContext("2d"),W=window.innerWidth,H=window.innerHeight,canvas.width=W,canvas.height=H,colors=new Array("red","lightgreen","blue","cyan","orange","gold","lime","purple"),initConfetti(),requestAnimationFrame(draw)}function StopConfetti(){$(canvas).removeClass("active"),void 0!=ctx&&(ctx.clearRect(0,0,W,H),start=null,endConfetti=!1)}window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;var canvas;$(document).ready(function(){canvas=$("#confetti").get(0)});var ctx,confettiHandler,W,H,mp=50,particles=[],maxconfettitime=8e3,endConfetti=!1,dt=0;$(window).resize(function(){W=window.innerWidth,H=window.innerHeight,canvas.width=W,canvas.height=H}),initConfetti=function(){for(var a=0;a<mp;a++){var b=~~(Math.random()*colors.length);particles.push({x:Math.random()*W,y:Math.random()*-H,r:randomFromTo(10,50),d:Math.random()*mp+10,color:colors[b],tilt:Math.floor(10*Math.random())-10,tiltAngleIncremental:.07*Math.random()+.05,tiltAngle:0,num:a})}},draw=function(a){ctx.clearRect(0,0,W,H);for(var b=0;b<particles.length;b++){var c=particles[b];ctx.beginPath(),ctx.lineWidth=c.r/2,ctx.strokeStyle=c.color,ctx.globalAlpha=1,ctx.moveTo(c.x+c.tilt+c.r/4,c.y),ctx.lineTo(c.x+c.tilt,c.y+c.tilt+c.r/4),ctx.stroke()}update(a)};var TiltChangeCountdown=5,angle=0,tiltAngle=0,oldtimestamp=0,start=null;
